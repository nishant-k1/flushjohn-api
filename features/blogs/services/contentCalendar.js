/**
 * Content Calendar Service
 * Manages rotating blog topics and seasonal scheduling for automated content generation
 */

export const contentCalendar = {
  citySpecific: [
    {
      title: "Porta Potty Rental Guide for Phoenix Weddings 2025",
      category: "events",
      city: "Phoenix",
      state: "AZ",
      keywords: [
        "porta potty rental Phoenix",
        "Phoenix wedding porta potty",
        "Phoenix wedding portable toilet rental",
      ],
      templateType: "citySpecific",
      season: "year-round",
    },
    {
      title: "Las Vegas Event Planning: Complete Porta Potty Rental Guide",
      category: "events",
      city: "Las Vegas",
      state: "NV",
      keywords: [
        "porta potty rental Las Vegas",
        "Las Vegas event porta potty",
        "Las Vegas portable toilet rental",
      ],
      templateType: "citySpecific",
      season: "year-round",
    },
    {
      title:
        "Seattle Construction Site Porta Potty Requirements & Best Practices",
      category: "construction",
      city: "Seattle",
      state: "WA",
      keywords: [
        "porta potty rental Seattle",
        "Seattle construction porta potty",
        "Seattle portable toilet rental",
      ],
      templateType: "citySpecific",
      season: "year-round",
    },
    {
      title: "Denver Outdoor Events: Porta Potty Rental Planning Guide",
      category: "events",
      city: "Denver",
      state: "CO",
      keywords: [
        "porta potty rental Denver",
        "Denver outdoor event porta potty",
        "Denver portable toilet rental",
      ],
      templateType: "citySpecific",
      season: "year-round",
    },
    {
      title: "Portland Music Festival Porta Potty Requirements & Setup",
      category: "events",
      city: "Portland",
      state: "OR",
      keywords: [
        "porta potty rental Portland",
        "Portland music festival porta potty",
        "Portland portable toilet rental",
      ],
      templateType: "citySpecific",
      season: "summer",
    },
    {
      title: "Nashville Corporate Events: Porta Potty Rental Solutions",
      category: "events",
      city: "Nashville",
      state: "TN",
      keywords: [
        "porta potty rental Nashville",
        "Nashville corporate event porta potty",
        "Nashville portable toilet rental",
      ],
      templateType: "citySpecific",
      season: "year-round",
    },
    {
      title: "Tampa Bay Beach Events: Complete Porta Potty Rental Guide",
      category: "events",
      city: "Tampa",
      state: "FL",
      keywords: [
        "porta potty rental Tampa",
        "Tampa beach event porta potty",
        "Tampa portable toilet rental",
      ],
      templateType: "citySpecific",
      season: "summer",
    },
    {
      title: "Kansas City Construction Porta Potty Regulations & Costs",
      category: "construction",
      city: "Kansas City",
      state: "MO",
      keywords: [
        "porta potty rental Kansas City",
        "Kansas City construction porta potty",
        "Kansas City portable toilet rental",
      ],
      templateType: "citySpecific",
      season: "year-round",
    },
  ],

  industryGuides: [
    {
      title:
        "Construction Site Porta Potty Maintenance: OSHA Compliance & Best Practices",
      category: "construction",
      keywords: [
        "construction porta potty maintenance",
        "OSHA porta potty cleaning",
        "construction site toilet upkeep",
      ],
      templateType: "industryGuide",
      season: "year-round",
      focus: "construction maintenance and OSHA compliance",
    },
    {
      title: "Porta Potty Maintenance: Keeping Units Clean and Functional",
      category: "tips",
      keywords: [
        "porta potty maintenance",
        "porta potty cleaning",
        "portable toilet upkeep",
      ],
      templateType: "industryGuide",
      season: "year-round",
      focus: "maintenance best practices",
    },
    {
      title: "Porta Potty Rental Contracts: What to Include and Avoid",
      category: "tips",
      keywords: [
        "porta potty rental contracts",
        "porta potty rental agreement",
        "portable toilet rental terms",
      ],
      templateType: "industryGuide",
      season: "year-round",
      focus: "contract terms and legal considerations",
    },
    {
      title: "Porta Potty Placement: Strategic Positioning for Events",
      category: "tips",
      keywords: [
        "porta potty placement",
        "porta potty positioning",
        "portable toilet setup",
      ],
      templateType: "industryGuide",
      season: "year-round",
      focus: "logistical planning and placement strategies",
    },
    {
      title: "Porta Potty Rental Insurance: Coverage and Liability Guide",
      category: "tips",
      keywords: [
        "porta potty rental insurance",
        "porta potty liability",
        "portable toilet coverage",
      ],
      templateType: "industryGuide",
      season: "year-round",
      focus: "insurance and liability considerations",
    },
    {
      title: "Porta Potty Rental vs Permanent Restrooms: Cost Analysis",
      category: "tips",
      keywords: [
        "porta potty vs permanent restrooms",
        "porta potty cost comparison",
        "portable toilet benefits",
      ],
      templateType: "industryGuide",
      season: "year-round",
      focus: "cost-benefit analysis and decision making",
    },
    {
      title: "Porta Potty Rental for Outdoor Weddings: Complete Planning Guide",
      category: "events",
      keywords: [
        "porta potty outdoor wedding",
        "wedding porta potty planning",
        "outdoor wedding restrooms",
      ],
      templateType: "industryGuide",
      season: "summer",
      focus: "wedding-specific planning and considerations",
    },
    {
      title: "Porta Potty Rental for Music Festivals: Capacity and Logistics",
      category: "events",
      keywords: [
        "porta potty music festival",
        "festival porta potty planning",
        "music event restrooms",
      ],
      templateType: "industryGuide",
      season: "summer",
      focus: "festival logistics and capacity planning",
    },
    {
      title: "Porta Potty Rental for Construction Sites: OSHA Compliance Guide",
      category: "construction",
      keywords: [
        "construction porta potty OSHA",
        "OSHA porta potty requirements",
        "construction site restrooms",
      ],
      templateType: "industryGuide",
      season: "year-round",
      focus: "OSHA compliance and construction regulations",
    },
    {
      title: "Construction Porta Potty Calculator: How Many Units Do You Need?",
      category: "construction",
      keywords: [
        "construction porta potty calculator",
        "how many porta potties construction site",
        "construction toilet requirements calculator",
      ],
      templateType: "industryGuide",
      season: "year-round",
      focus: "construction site planning and capacity calculations",
    },
    {
      title:
        "Construction Site Porta Potty Placement: Safety and Compliance Guide",
      category: "construction",
      keywords: [
        "construction porta potty placement",
        "construction site toilet positioning",
        "OSHA porta potty placement requirements",
      ],
      templateType: "industryGuide",
      season: "year-round",
      focus: "construction site safety and OSHA placement requirements",
    },
  ],

  seasonal: [
    {
      title:
        "Spring Wedding Season: Porta Potty Planning for Outdoor Ceremonies",
      category: "events",
      keywords: [
        "spring wedding porta potty",
        "outdoor wedding porta potty",
        "spring wedding planning",
      ],
      templateType: "seasonal",
      season: "spring",
      focus: "spring wedding planning and weather considerations",
    },
    {
      title: "Summer Festival Season: Porta Potty Rental for Outdoor Events",
      category: "events",
      keywords: [
        "summer festival porta potty",
        "outdoor festival porta potty",
        "summer event planning",
      ],
      templateType: "seasonal",
      season: "summer",
      focus: "summer event planning and heat considerations",
    },
    {
      title:
        "Fall Construction Projects: Porta Potty Rental for Building Season",
      category: "construction",
      keywords: [
        "fall construction porta potty",
        "construction season porta potty",
        "fall building projects",
      ],
      templateType: "seasonal",
      season: "fall",
      focus: "fall construction planning and weather preparation",
    },
    {
      title: "Winter Events: Porta Potty Rental for Cold Weather Celebrations",
      category: "events",
      keywords: [
        "winter event porta potty",
        "cold weather porta potty",
        "winter celebration planning",
      ],
      templateType: "seasonal",
      season: "winter",
      focus: "winter event planning and cold weather considerations",
    },
    {
      title:
        "Holiday Party Season: Porta Potty Rental for Corporate Celebrations",
      category: "events",
      keywords: [
        "holiday party porta potty",
        "corporate holiday porta potty",
        "holiday event planning",
      ],
      templateType: "seasonal",
      season: "winter",
      focus: "holiday party planning and corporate events",
    },
    {
      title: "Back-to-School Season: Porta Potty Rental for Campus Events",
      category: "events",
      keywords: [
        "school event porta potty",
        "campus porta potty rental",
        "back to school events",
      ],
      templateType: "seasonal",
      season: "fall",
      focus: "educational institution events and campus planning",
    },
  ],
};

export function getCurrentSeason() {
  const month = new Date().getMonth() + 1; // 1-12
  if (month >= 3 && month <= 5) return "spring";
  if (month >= 6 && month <= 8) return "summer";
  if (month >= 9 && month <= 11) return "fall";
  return "winter";
}

export function getNextTopic(contentType = null, randomize = false) {
  const season = getCurrentSeason();
  const currentDate = new Date();
  const weekNumber = Math.ceil(currentDate.getDate() / 7);

  let availableTopics = [];

  if (contentType === "construction") {
    availableTopics = [
      ...contentCalendar.citySpecific.filter(
        (topic) =>
          topic.category === "construction" &&
          (topic.season === "year-round" || topic.season === season)
      ),
      ...contentCalendar.industryGuides.filter(
        (topic) =>
          topic.category === "construction" &&
          (topic.season === "year-round" || topic.season === season)
      ),
      ...contentCalendar.seasonal.filter(
        (topic) =>
          topic.category === "construction" &&
          (topic.season === season || topic.season === "year-round")
      ),
    ];
  } else if (contentType === "city") {
    availableTopics = contentCalendar.citySpecific.filter(
      (topic) => topic.season === "year-round" || topic.season === season
    );
  } else if (contentType === "problemSolving") {
    availableTopics = [
      ...contentCalendar.industryGuides.filter(
        (topic) => topic.season === "year-round" || topic.season === season
      ),
      ...contentCalendar.seasonal.filter(
        (topic) => topic.season === season || topic.season === "year-round"
      ),
    ];
  } else {
    const categoryRotation = weekNumber % 4;

    switch (categoryRotation) {
      case 0: // City-specific content
        availableTopics = contentCalendar.citySpecific.filter(
          (topic) => topic.season === "year-round" || topic.season === season
        );
        break;
      case 1: // Industry guides
        availableTopics = contentCalendar.industryGuides.filter(
          (topic) => topic.season === "year-round" || topic.season === season
        );
        break;
      case 2: // Seasonal content
        availableTopics = contentCalendar.seasonal.filter(
          (topic) => topic.season === season || topic.season === "year-round"
        );
        break;
      case 3: // Mixed content (random selection)
        availableTopics = [
          ...contentCalendar.citySpecific,
          ...contentCalendar.industryGuides,
          ...contentCalendar.seasonal,
        ].filter(
          (topic) => topic.season === "year-round" || topic.season === season
        );
        break;
    }
  }

  let topicIndex;
  if (randomize) {
    // For manual generation, use random selection to avoid duplicates
    topicIndex = Math.floor(Math.random() * availableTopics.length);
  } else {
    // For scheduled generation, use deterministic rotation
    topicIndex = weekNumber % availableTopics.length;
  }
  return availableTopics[topicIndex];
}

export function getTopicsForSeason(season) {
  return [
    ...contentCalendar.citySpecific.filter(
      (topic) => topic.season === "year-round" || topic.season === season
    ),
    ...contentCalendar.industryGuides.filter(
      (topic) => topic.season === "year-round" || topic.season === season
    ),
    ...contentCalendar.seasonal.filter(
      (topic) => topic.season === season || topic.season === "year-round"
    ),
  ];
}

export function getCalendarStats() {
  const season = getCurrentSeason();
  const allTopics = getTopicsForSeason(season);

  return {
    totalTopics: allTopics.length,
    citySpecific: allTopics.filter((t) => t.templateType === "citySpecific")
      .length,
    industryGuides: allTopics.filter((t) => t.templateType === "industryGuide")
      .length,
    seasonal: allTopics.filter((t) => t.templateType === "seasonal").length,
    currentSeason: season,
    nextTopic: getNextTopic(),
  };
}
